(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{HdJu:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i("AytR"),r=i("Iab2"),a=i("8oAO"),o=i("I+dG"),s=i("fXoL"),l=i("tk/3");let c=(()=>{class t{constructor(t,e){this.http=t,this.analyticsService=e}hGetCustomizedCreditParameters(t){return this.http.get(n.a.uri+"api/restricted/products/customizedcredit/parameters",{params:t})}hPostProduct(t){return this.http.post(n.a.uri+"api/restricted/products",t)}hPatchNotificationConfirmation(t){return this.http.patch(`${n.a.uri}api/restricted/products/delivery/${t}/notification`,null)}hGetNoaParameters(){return this.http.get(n.a.uri+"api/restricted/products/overdues/parameters")}hGetNoaFollowUp(t){return this.http.get(`${n.a.uri}api/restricted/products/overdues-followup/${t}`)}hPostNoaEvaluation(t){return this.http.post(n.a.uri+"/api/restricted/products/overdues/overdue-evaluation",t)}hPostNoa(t){return this.http.post(n.a.uri+"/api/restricted/products/overdues",t)}hDeleteNoaProduct(t){return this.http.delete(`${n.a.uri}api/restricted/products/overdues/${t}`)}hGetSegmentContract(t){return this.http.get(`${n.a.uri}api/restricted/products/overdues/segmentSquad/${t}`)}hGetOrderCoverLimitParameters(){return this.http.get(n.a.uri+"api/restricted/products/ordercoverlimit/parameters")}hGetReptParameters(t){return this.http.get(n.a.uri+"api/restricted/products/report/parameters",{params:t})}hPostToplinerSimulation(t){return this.http.post(n.a.uri+"api/restricted/products/topliner-simulation",t)}hPostTopliner(t){return this.http.post(n.a.uri+"api/restricted/products/topliner",t)}hGetRiskClaimParameters(t){return this.http.get(n.a.uri+"api/restricted/products/riskclaim/parameters",{params:t})}hGetInvoiceTemplate(){return this.http.get(n.a.uri+"api/restricted/products/edd/template/invoices")}hGetInvoiceOverduesTemplate(){return this.http.get(n.a.uri+"api/restricted/products/overdues/template/invoices")}hGetInvoiceONFTemplate(){return this.http.get(n.a.uri+"api/restricted/products/onf/template/invoices")}hGetOrderONFTemplate(){return this.http.get(n.a.uri+"api/restricted/products/onf/template/orders")}hGetPaymentOverduesTemplate(){return this.http.get(n.a.uri+"api/restricted/products/overdues/template/payments")}hGetDownloadInvoiceTemplate(t){this.http.get(`${n.a.uri}api/restricted/documents/${t}`,{observe:"response",responseType:"blob"}).subscribe(t=>{const e=t.headers.get("Content-Disposition").split(";")[1].split("=")[1],i=new Blob([t.body],{type:t.headers.get("Content-Type")});Object(r.saveAs)(i,e),this.handleAnalyticsDownloadEvent(e)})}hPostProcessInvoices(t){return this.http.post(n.a.uri+"api/restricted/products/overdues/noa/process-invoices",t)}hPostProcessPayment(t){return this.http.post(n.a.uri+"api/restricted/products/overdues/noa/process-payments",t)}hPostInteractiveDialogOption(t){return this.http.get(n.a.uri+"api/restricted/products/interactive-dialog",{params:t})}handleAnalyticsDownloadEvent(t){const e=new o.c(o.e.Engagement,o.d.download,t);this.analyticsService.triggerGtmTagEvent(e)}}return t.\u0275fac=function(e){return new(e||t)(s.fc(l.b),s.fc(a.a))},t.\u0275prov=s.Ob({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},kjr3:function(t,e,i){"use strict";i.d(e,"a",(function(){return W}));var n=i("mrSG"),r=i("fXoL"),a=i("LvDl"),o=i.n(a),s=i("quSY"),l=i("I+dG"),c=i("1ATV"),p=i("1kSV");let u=(()=>{class t{constructor(t){this.modal=t,this.visible=!0}close(){this.visible=!1,this.modal.close()}}return t.\u0275fac=function(e){return new(e||t)(r.Sb(p.a))},t.\u0275cmp=r.Mb({type:t,selectors:[["cad-failed-antivirus-scan-modal"]],decls:13,vars:6,consts:[[1,"c-modal"],[1,"c-modal__opac-layer"],[1,"c-modal__content"],[1,"c-modal__close-icon",3,"click"],[1,"las","la-times"],["l10nTranslate","",1,"c-modal__title"],["l10nTranslate","",1,"c-modal__parag"],[1,"c-modal__confirm-button-container"],["l10nTranslate","",1,"c-button","c-button--primary","c-button--upload",3,"click"]],template:function(t,e){1&t&&(r.Xb(0,"div",0),r.Tb(1,"div",1),r.Xb(2,"div",2),r.Xb(3,"button",3),r.jc("click",(function(){return e.close()})),r.oc(4,"translate"),r.Tb(5,"i",4),r.Wb(),r.Xb(6,"h3",5),r.Tc(7,"CofaNet.popin.antiVirus.title.fail"),r.Wb(),r.Xb(8,"p",6),r.Tc(9,"CofaNet.popin.antiVirus.texte.fail"),r.Wb(),r.Xb(10,"div",7),r.Xb(11,"button",8),r.jc("click",(function(){return e.close()})),r.Tc(12,"CofaNet.popin.antiVirus.button.newDocument"),r.Wb(),r.Wb(),r.Wb(),r.Wb()),2&t&&(r.Kb("c-modal--visible",e.visible),r.Fb(3),r.Gb("arial-label",r.qc(4,3,"CofaNet.accessibility.iconPopin.close",e.lang)))},directives:[c.q],pipes:[c.r],styles:[""]}),Object(n.b)([Object(c.k)(),Object(n.c)("design:type",String)],t.prototype,"lang",void 0),t})();var d=i("HdJu"),h=i("8oAO"),m=i("tk/3"),b=i("AytR");let v=(()=>{class t{constructor(t){this.http=t,this.uriService="api/public",this.uriServiceIcap="/icapclient-v1"}getToken(){return this.http.get(`${b.a.uri}${this.uriService}/cofanetApiAuthentication`)}scanFile(t,e){const i=`${e.icapUrl}${this.uriServiceIcap}/scan`,n={headers:new m.d({"x-api-key":""+e.xApiKey,Authorization:""+e.idToken}),withCredentials:!0},r=new FormData;return r.append("file",t,t.name),this.http.post(i,r,n)}}return t.\u0275fac=function(e){return new(e||t)(r.fc(m.b))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=i("1Znx"),g=i("3Pt+"),y=i("QX5u"),I=i("ofXK");function F(t,e){if(1&t&&(r.Xb(0,"div"),r.Tb(1,"p",6),r.Xb(2,"div",7),r.Xb(3,"button",8),r.Tc(4,"CofaNet.bulkImport.file.import"),r.Wb(),r.Wb(),r.Wb()),2&t){const t=r.nc();r.Fb(1),r.vc("innerHTML",t.placeholder?t.placeholder:"CofaNet.document.dropzone.placeholder.multi",r.Kc),r.Fb(2),r.vc("disabled",t.disabled)}}function C(t,e){1&t&&(r.Vb(0),r.Tc(1,"..."),r.Ub())}function T(t,e){if(1&t){const t=r.Yb();r.Xb(0,"div",16),r.Xb(1,"span",17),r.Tc(2),r.oc(3,"slice"),r.Rc(4,C,2,0,"ng-container",3),r.Xb(5,"button",18),r.jc("click",(function(i){r.Jc(t);const n=e.$implicit;return r.nc(2).removeFileEvent(i,n)})),r.Tb(6,"i",19),r.Wb(),r.Wb(),r.Wb()}if(2&t){const t=e.$implicit;r.Fb(2),r.Vc("",r.rc(3,2,t.name,0,50)," "),r.Fb(2),r.vc("ngIf",t.name.length>50)}}function S(t,e){1&t&&(r.Xb(0,"button",20),r.Tc(1," CofaNet.subscriberManagement.import.upload.title "),r.Wb())}function G(t,e){1&t&&(r.Xb(0,"button",21),r.Tc(1,"CofaNet.subscriberManagement.import.upload.modify"),r.Wb())}function w(t,e){if(1&t&&(r.Xb(0,"div",9),r.Xb(1,"div",10),r.Xb(2,"div",11),r.Rc(3,T,7,6,"div",12),r.Wb(),r.Wb(),r.Xb(4,"div",13),r.Rc(5,S,2,0,"button",14),r.Rc(6,G,2,0,"ng-template",null,15,r.Sc),r.Wb(),r.Wb()),2&t){const t=r.Gc(7),e=r.nc();r.Fb(3),r.vc("ngForOf",e.formGroup.value[e.controlName]),r.Fb(2),r.vc("ngIf",e.multiple)("ngIfElse",t)}}function N(t,e){1&t&&(r.Xb(0,"div",24),r.Xb(1,"label",25),r.Tc(2," CofaNet.global.import.error.extension"),r.Wb(),r.Wb())}function _(t,e){1&t&&(r.Xb(0,"div",24),r.Xb(1,"label",25),r.Tc(2," CofaNet.global.import.fileTooBig "),r.Wb(),r.Wb())}function A(t,e){1&t&&(r.Xb(0,"div",24),r.Xb(1,"label",25),r.Tc(2," CofaNet.global.import.fileWithEspecialCharacter "),r.Wb(),r.Wb())}function P(t,e){if(1&t&&(r.Xb(0,"div",22),r.Rc(1,N,3,0,"div",23),r.Rc(2,_,3,0,"div",23),r.Rc(3,A,3,0,"div",23),r.Wb()),2&t){const t=r.nc();r.Fb(1),r.vc("ngIf",t.lastInvalids&&"accept"===t.lastInvalids[0].type),r.Fb(1),r.vc("ngIf",t.lastInvalids&&"fileSize"===t.lastInvalids[0].type),r.Fb(1),r.vc("ngIf",t.hasSpecialCharInLastAddedFile&&t.needAntivirusScan)}}const X=function(t){return{busy:t,delay:0,message:"CofaNet.loader.antiVirus.scan.message",fullPage:!0}},O=function(t){return{busy:t,delay:0}};let W=(()=>{class t{constructor(t,e,i,n){this.orderService=t,this.analyticsService=e,this.antivirusService=i,this.modal=n,this.maxSize="10485760",this.needAntivirusScan=!1,this.itemChange=new r.q,this.scanCompleted=new r.q}removeFileEvent(t,e){t.stopPropagation(),this.removeFile(e)}importFile(){this.hasSpecialCharInLastAddedFile=!1;const t=this.formGroup.get(this.controlName).value,e=t[t.length-1],i=e.name.length,n=e.name.replace(/[^a-zA-Z 0-9._-]/g,"").length;this.needAntivirusScan?i===n?(this.removeFile(e),this.scanFileByAntivirus(e)):(this.hasSpecialCharInLastAddedFile=!0,this.removeFile(e)):this.processImportedFile()}removeFile(t){const e=this.formGroup.controls[this.controlName].value.indexOf(t);-1!==e&&(this.formGroup.controls[this.controlName].value.splice(e,1),this.isImportFile&&(this.isFile=!1,this.itemChange.emit({action:"remove"})))}scanFileByAntivirus(t){this.antivirusScanBusy=this.antivirusService.getToken().subscribe(e=>{this.antivirusService.scanFile(t,e).subscribe(e=>{this.scanCompleted.emit(e),this.handleAntivirusScanResult(!0,t)},e=>{this.handleAntivirusScanResult(!1,t)})})}handleAntivirusScanResult(t,e){!0===t?(this.formGroup.get(this.controlName).value.push(e),this.processImportedFile()):this.modal.open(u)}processImportedFile(){!this.multiple&&this.formGroup.value[this.controlName].length>1&&this.formGroup.controls[this.controlName].setValue([o.a.last(this.formGroup.value[this.controlName])]),this.analyticsUploadType&&this.toggleUploadFileAnalyticsService(),!this.isImportFile||this.isFile||this.withAPI?this.withAPI?setTimeout(()=>{this.itemChange.emit({action:"add",data:this.formGroup.value[this.controlName][0]})}):this.itemChange.emit({action:"add",name:this.controlName,data:this.formGroup.value[this.controlName]}):(this.showBusy=new s.a,setTimeout(()=>{this.processImport()}))}processImport(){const t=this.formGroup.value[this.controlName][0],e=new FileReader;t?(e.readAsText(t,"ISO-8859-1"),e.onload=t=>{const i=e.result.toString().split(/\r|\n|\r/),n=[];for(let e=0;e<i.length;e++)""!==i[e]&&n.push(i[e]);this.itemChange.emit({action:"add",data:n})}):(this.isFile=!1,this.showBusy.unsubscribe()),this.showBusy.unsubscribe()}toggleUploadFileAnalyticsService(){const t=new l.c(l.e.Engagement,l.d.import,this.analyticsUploadType);this.analyticsService.triggerGtmTagEvent(t)}}return t.\u0275fac=function(e){return new(e||t)(r.Sb(d.a),r.Sb(h.a),r.Sb(v),r.Sb(p.g))},t.\u0275cmp=r.Mb({type:t,selectors:[["cof-file-drop"]],inputs:{multiple:"multiple",maxSize:"maxSize",formatsAllowed:"formatsAllowed",disabled:"disabled",isImportFile:"isImportFile",controlName:"controlName",placeholder:"placeholder",formGroup:"formGroup",placeHolder:"placeHolder",withAPI:"withAPI",uploadType:"uploadType",analyticsUploadType:"analyticsUploadType",needAntivirusScan:"needAntivirusScan"},outputs:{itemChange:"itemChange",scanCompleted:"scanCompleted"},decls:7,vars:27,consts:[[3,"ngBusy"],[1,"c-file-input",3,"ngBusy","formGroup"],["ngfDrop","",1,"well","my-drop-zone",3,"multiple","validDrag","files","selectable","accept","maxSize","lastInvalids","dragFiles","fileDropDisabled","validDragChange","filesChange","lastInvalidsChange","dragFilesChange"],[4,"ngIf"],["class","c-file-input--files-uploaded",4,"ngIf"],["style","text-align: left !important",4,"ngIf"],["l10nTranslate","",1,"c-file-input__drag-drop-label",3,"innerHTML"],[1,"c-file-input__init-button-container"],["id","importFile","type","button","l10nTranslate","",1,"c-button","c-button--primary","c-button--upload",3,"disabled"],[1,"c-file-input--files-uploaded"],[1,"col-8","c-file-input__files-container"],[1,"row"],["class","ml-2 mb-4",4,"ngFor","ngForOf"],[1,"c-file-input__add-file-button-container"],["class","c-button c-button--primary c-button--add-file","type","button","l10nTranslate","",4,"ngIf","ngIfElse"],["modifyUpload",""],[1,"ml-2","mb-4"],[1,"c-badge","name","text-nowrap"],[1,"c-badge__button",3,"click"],[1,"las","la-times"],["type","button","l10nTranslate","",1,"c-button","c-button--primary","c-button--add-file"],["type","button","l10nTranslate","",1,"c-button","c-button--primary"],[2,"text-align","left !important"],["l10nTranslate","",4,"ngIf"],["l10nTranslate",""],["l10nTranslate","",1,"text-danger","pull-left"]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Xb(1,"div",1),r.Xb(2,"div",2),r.jc("validDragChange",(function(t){return e.validComboDrag=t}))("filesChange",(function(t){return e.formGroup.value[e.controlName]=t}))("lastInvalidsChange",(function(t){return e.lastInvalids=t}))("dragFilesChange",(function(t){return e.dragFiles=t}))("filesChange",(function(){return e.importFile()})),r.oc(3,"translate"),r.Rc(4,F,5,2,"div",3),r.Rc(5,w,8,3,"div",4),r.Wb(),r.Wb(),r.Rc(6,P,4,3,"div",5)),2&t&&(r.vc("ngBusy",r.zc(23,X,e.antivirusScanBusy)),r.Fb(1),r.Kb("invalid-drag",null==e.lastInvalids?null:e.lastInvalids.length)("disabled",e.disabled),r.vc("ngBusy",r.zc(25,O,e.showBusy))("formGroup",e.formGroup),r.Fb(1),r.vc("multiple",e.multiple)("validDrag",e.validComboDrag)("files",e.formGroup.value[e.controlName])("selectable",!0)("accept",e.formatsAllowed)("maxSize",e.maxSize)("lastInvalids",e.lastInvalids)("dragFiles",e.dragFiles)("fileDropDisabled",e.disabled),r.Gb("arial-label",r.qc(3,20,"CofaNet.accessibility.fieldDrop.importFile",e.lang)),r.Fb(2),r.vc("ngIf",e.formGroup.value&&e.formGroup.value[e.controlName]&&0===e.formGroup.value[e.controlName].length),r.Fb(1),r.vc("ngIf",e.formGroup&&e.formGroup.value[e.controlName]&&e.formGroup.value[e.controlName].length>0),r.Fb(1),r.vc("ngIf",!e.validComboDrag||(null==e.lastInvalids?null:e.lastInvalids.length)||e.hasSpecialCharInLastAddedFile&&e.needAntivirusScan))},directives:[f.c,g.s,g.k,y.a,I.u,c.q,I.t],pipes:[c.r,I.F],styles:[".c-file-input[_ngcontent-%COMP%]{min-height:15rem;margin-top:1rem}.c-file-input__drag-drop-label[_ngcontent-%COMP%]{margin-top:0;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;padding-top:3.5rem}.c-file-input__init-button-container[_ngcontent-%COMP%]{padding-bottom:1.3rem;margin-top:1.3rem;-ms-flex-pack:center;justify-content:center}.c-file-input.invalid-drag[_ngcontent-%COMP%]{border:.2rem dashed red}.c-file-input.disabled[_ngcontent-%COMP%]{background:#ddd}@media only screen and (max-width:890px){.c-file-input[_ngcontent-%COMP%]{min-height:auto;margin-top:inherit;border:none}.c-file-input__init-button-container[_ngcontent-%COMP%]{padding-bottom:inherit;margin-top:inherit;-ms-flex-pack:end;justify-content:flex-end}.c-file-input__drag-drop-label[_ngcontent-%COMP%]{display:none;padding-top:inherit}}.my-drop-zone[_ngcontent-%COMP%]{min-height:inherit}"]}),Object(n.b)([Object(c.k)(),Object(n.c)("design:type",String)],t.prototype,"lang",void 0),t})()}}]);